<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>My Page</title>
    <link type="text/css" href="static/css/styles.css" rel="stylesheet" />
    <link rel="stylesheet" href="static/css/index.css" />
</head>

<body>
    <!-- Á¨¨‰∏ÄÈ°µÔºö‰∏ªÈ°µÈù¢ -->
    <section class="page-section">
        <canvas class="bg-glow" id="bgGlow"></canvas>
        <div class="main-content">
            <div class="left-img">
                <img src="imerge/star.png" id="star-img" alt="star" />
            </div>
            <div class="center-text">
                <span style="font-size:7vw;">BE SLEEPLY !</span><br>
                <span class="creative"> &nbsp &nbsp &nbsp CREATIVE!</span><br>
                <span class="and">AND</span> <span class="cool">LAZY!</span>
            </div>
            <div class="right-geo">
                <img src="imerge/mogu.png" id="mogu-img" alt="mogu" />
            </div>
            <button class="contact-btn" onclick="window.location.href='intro.html'">introduction</button>
            <!-- <button class="view-btn" onclick="scrollToView()" style="position: absolute; bottom: 50px; right: 50px; background: linear-gradient(45deg, #39ff14, #00ff41); color: black; border: none; padding: 10px 20px; border-radius: 25px; font-weight: bold; cursor: pointer; z-index: 20; box-shadow: 0 0 20px rgba(57, 255, 20, 0.6); transition: all 0.3s ease;">VIEW</button> -->
            <div class="bottom-tip" onclick="scrollToAscii()">SCROLL CAREFULLY, IT'S SMOOTH<br>Â∞è„ÉªÂøÉ„ÉªÂú∞„ÉªÊªë</div>
            <div class="scroll-indicator"></div>

            <div class="music-player"
                style="position:absolute; top:40px; left:40px; z-index:30; background:rgba(20,20,20,0.8); border-radius:16px; box-shadow:0 0 10px #14ffeb; padding:18px 24px; display:flex; align-items:center; gap:16px;">
                <audio id="main-audio" src="static/assets/music.MP3" preload="auto"></audio>
                <button id="volume-btn"
                    style="background:#fff; color:#14ffeb; border:2px solid #14ffeb; border-radius:50%; width:40px; height:40px; font-size:20px; font-weight:bold; cursor:pointer; position:relative;">üîä
                    <span id="volume-tip"
                        style="display:none; position:absolute; left:50%; top:-32px; transform:translateX(-50%); background:rgba(20,20,20,0.95); color:#14ffeb; padding:4px 12px; border-radius:8px; font-size:14px; white-space:nowrap; z-index:100; box-shadow:0 0 8px #14ffeb;">ÈïøÊåâË∞ÉËäÇÈü≥Èáè~</span>
                </button>
                <div style="position:relative; width:220px; height:24px; margin-left:8px;">
                    <div
                        style="position:absolute; top:12px; left:0; width:200px; height:2px; background:#ccc; border-radius:2px;">
                    </div>
                    <div id="volume-bar"
                        style="position:absolute; top:7px; left:0; height:12px; background:#14ffeb; border-radius:6px; width:10%; transition:width 0.1s;">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Á¨¨‰∫åÈ°µÔºöASCIIÂä®ÁîªÈ°µÈù¢ -->
    <section class="page-section ascii-section">
        <div class="ascii-container">
            <div class="window-frame">
                <div class="window-header">
                    <div class="window-controls">
                        <div class="window-control"></div>
                        <div class="window-control"></div>
                        <div class="window-control"></div>
                    </div>
                    <div class="window-title">ASCII ANIMATION</div>
                    <div class="window-buttons">
                        <div class="window-btn btn-minimize"></div>
                        <div class="window-btn btn-restore"></div>
                        <div class="window-btn btn-close"></div>
                    </div>
                </div>
                <div class="ascii-display">
                    <pre id="asciiContainer"></pre>
                </div>
            </div>
        </div>
        <div class="bottom-tip" onclick="scrollToContact()"
            style="position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 20;">NEXT
            PAGE<br>‰∏ã‰∏ÄÈ°µ</div>
    </section>

    <!-- Á¨¨‰∏âÈ°µÔºöËÅîÁ≥ªÈ°µÈù¢ -->
    <section class="page-section contact-section">
        <div class="contact-container">
            <div class="left-nav">
                <div class="nav-menu">
                    <div class="nav-item active" data-target="home">
                        <span class="chinese">‰∏ªÈ°µ</span>HOME
                    </div>
                    <div class="nav-item" data-target="videos">
                        <span class="chinese">ËßÜÈ¢ë</span>VIDEOS
                    </div>
                    <div class="nav-item" data-target="photos">
                        <span class="chinese">ÂõæÁâá</span>PHOTOS
                    </div>
                    <div class="nav-item" data-target="contact">
                        <span class="chinese">ËÅîÁ≥ª</span>CONTACT
                    </div>
                </div>
                <div class="contact-info">
                    <div class="contact-title">GET IN TOUCH ///</div>
                    <div class="contact-details">
                        <div><strong>Email:</strong> 3583818830@qq.com</div>
                        <div><strong>Github:</strong> yamatanooroch</div>
                        <div><strong>QQ:</strong> 3583818830</div>
                    </div>
                </div>
                <!-- <div class="copyright">
                    ËúÄICPÂ§á20220223Âè∑-2
                </div> -->
            </div>
            <div class="buildings-container">
                <div class="building building-1" id="building1"></div>
                <div class="building building-2" id="building2"></div>
                <div class="building building-3" id="building3"></div>
                <div class="building building-4" id="building4"></div>
                <div class="building building-5" id="building5"></div>
                <div class="bottom-text">ÂéªËæπÁïå‰ª•Â§ñÂØªÊâæÂØºËà™ËÆæËÆ°!</div>
            </div>
        </div>
        <div class="bottom-tip" onclick="scrollToCreativity()"
            style="position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 20;">NEXT
            PAGE<br>‰∏ã‰∏ÄÈ°µ</div>
    </section>

    <!-- Á¨¨ÂõõÈ°µÔºöÂàõÊÑèÈ°µÈù¢ -->
    <section class="page-section creativity-section">
        <div class="creativity-container">
            <div class="left-content">
                <div class="main-text">
                    <h1>FULL OF CREATIVITY</h1>
                    <h2>ABLE TO <span class="highlight">IMAGINE</span></h2>
                    <h3><span class="outline">&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp
                            &nbsp&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp
                            &nbsp &nbsp &nbsp CLICK</span> THESE CIRCLES</h3>
                </div>
            </div>
            <div class="right-content">
                <img src="imerge/mogu.png" id="mogu-brain" alt="mogu brain" />
            </div>
            <div class="physics-canvas-container">
                <canvas id="physicsCanvas"></canvas>
            </div>
        </div>
        <div class="bottom-tip" onclick="scrollToView()"
            style="position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 20;">NEXT
            PAGE<br>‰∏ã‰∏ÄÈ°µ</div>
    </section>

    <!-- Á¨¨‰∫îÈ°µÔºöËßÜËßâÈ°µÈù¢ -->
    <section class="page-section view-section">
        <div class="scrolling-text-container">
            <!-- Â•áÊï∞Ë°åÂêëÂ∑¶ÊªöÂä® -->
            <div class="text-row odd-row">
                <div class="scrolling-text left">VIEW FIRST VISUAL FIRST VIEW FIRST VISUAL FIRST VIEW FIRST VISUAL FIRST
                    VIEW FIRST VISUAL FIRST </div>
            </div>
            <div class="text-row even-row">
                <div class="scrolling-text right">STARE VISUAL STARE VISUAL STARE VISUAL STARE VISUAL STARE VISUAL STARE
                    VISUAL STARE </div>
            </div>
            <div class="text-row odd-row">
                <div class="scrolling-text left">VIEW FIRST VISUAL FIRST VIEW FIRST VISUAL FIRST VIEW FIRST VISUAL FIRST
                    VIEW FIRST VISUAL FIRST </div>
            </div>
            <div class="text-row even-row">
                <div class="scrolling-text right">STARE VISUAL STARE VISUAL STARE VISUAL STARE VISUAL STARE VISUAL STARE
                    VISUAL STARE VISUAL STARE </div>
            </div>
            <div class="text-row odd-row">
                <div class="scrolling-text left">VIEW FIRST VISUAL FIRST VIEW FIRST VISUAL FIRST VIEW FIRST VISUAL FIRST
                    VIEW FIRST VISUAL FIRST </div>
            </div>
            <div class="text-row even-row">
                <div class="scrolling-text right">STARE VISUAL STARE VISUAL STARE VISUAL STARE VISUAL STARE VISUAL STARE
                    VISUAL STARE VISUAL STARE </div>
            </div>
        </div>

        <div class="eye-container">
            <div class="eye-background">
                <div class="eye-pupil">
                    <div class="eye-highlight"></div>
                </div>
                <div class="eye-lines">
                    <div class="line line-1"></div>
                    <div class="line line-2"></div>
                    <div class="line line-3"></div>
                    <div class="line line-4"></div>
                </div>
            </div>
            <div class="corner-markers">
                <div class="corner corner-tl">ËßÜ</div>
                <div class="corner corner-tr">Ëßâ</div>
                <div class="corner corner-bl">Ëá≥</div>
                <div class="corner corner-br">‰∏ä</div>
            </div>
        </div>

        <div class="bottom-tip" onclick="scrollToTop()"
            style="position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 20;">BACK TO
            TOP<br>ËøîÂõûÈ°∂ÈÉ®</div>
    </section>

    <!-- ÊÅ≠ÂñúÈ°µÈù¢ -->
    <div id="congratulationModal" class="modal">
        <div class="modal-content">
            <h2> CONGRATULATIONS! </h2>
            <p>You've lit up all the bulbs!</p>
            <p>‰Ω†Â•ΩÈó≤ÔºÅüí°</p>
            <button onclick="closeModal()">Continue</button>
        </div>
    </div>
    <script>
        // Èº†Ê†áË∑üÈöèÁªøËâ≤ÂÖâÊñë
        const canvas = document.getElementById('bgGlow');
        const ctx = canvas.getContext('2d');
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        let mouseX = window.innerWidth / 2, mouseY = window.innerHeight / 2;
        document.addEventListener('mousemove', e => {
            mouseX = e.clientX;
            mouseY = e.clientY;
        });
        function drawGlow() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // ‰∏ªÂÖâÊñë
            let grad1 = ctx.createRadialGradient(mouseX, mouseY, 0, mouseX, mouseY, 350);
            grad1.addColorStop(0, 'rgba(20,255,235,0.45)');
            grad1.addColorStop(1, 'rgba(20,255,235,0)');
            ctx.globalCompositeOperation = 'lighter';
            ctx.fillStyle = grad1;
            ctx.fillRect(mouseX - 350, mouseY - 350, 700, 700);
            // ËæπÁºòÂÖâÊñë
            let grad2 = ctx.createRadialGradient(canvas.width - mouseX, canvas.height - mouseY, 0, canvas.width - mouseX, canvas.height - mouseY, 300);
            grad2.addColorStop(0, 'rgba(20,255,235,0.25)');
            grad2.addColorStop(1, 'rgba(20,255,235,0)');
            ctx.fillStyle = grad2;
            ctx.fillRect(canvas.width - mouseX - 300, canvas.height - mouseY - 300, 600, 600);
            ctx.globalCompositeOperation = 'source-over';
        }
        setInterval(drawGlow, 16);

        // star.pngÊóãËΩ¨Âä®Áîª
        const starImg = document.getElementById('star-img');
        let starAngle = 0;
        function rotateStar() {
            starAngle += 1.2;
            starImg.style.transform = `rotate(${starAngle}deg)`;
            requestAnimationFrame(rotateStar);
        }

        rotateStar();

        // moguÂõæÁâáÈöèÊú∫ÁßªÂä®Âä®Áîª
        const moguImg = document.getElementById('mogu-img');
        let isAnimating = false;

        moguImg.addEventListener('mouseenter', function (e) {
            if (isAnimating) return;

            isAnimating = true;
            const mouseX = e.clientX;
            const mouseY = e.clientY;

            // ÁîüÊàêÈöèÊú∫ËßíÂ∫¶Âíå100pxË∑ùÁ¶ª
            const angle = Math.random() * 2 * Math.PI;
            const distance = 100;

            // ËÆ°ÁÆóÊñ∞‰ΩçÁΩÆ
            const newX = mouseX + Math.cos(angle) * distance;
            const newY = mouseY + Math.sin(angle) * distance;

            // Ëé∑ÂèñÂõæÁâáÂΩìÂâç‰ΩçÁΩÆ
            const rect = moguImg.getBoundingClientRect();
            const currentX = rect.left + rect.width / 2;
            const currentY = rect.top + rect.height / 2;

            // ËÆ°ÁÆóÁßªÂä®Ë∑ùÁ¶ª
            const moveX = newX - currentX;
            const moveY = newY - currentY;

            // Â∫îÁî®ÂèòÊç¢
            moguImg.style.transform = `translate(${moveX}px, ${moveY}px) scale(1.1)`;
            moguImg.style.filter = 'brightness(1.2) drop-shadow(0 0 20px rgba(20, 255, 235, 0.8))';

            // 1ÁßíÂêéÊÅ¢Â§çÂéü‰Ωç
            setTimeout(() => {
                moguImg.style.transform = 'translate(0, 0) scale(1)';
                moguImg.style.filter = 'brightness(1) drop-shadow(0 0 15px rgba(20, 255, 235, 0.3))';
                isAnimating = false;
            }, 1000);
        });

        // ÊªöÂä®ÂäüËÉΩ
        function scrollToAscii() {
            document.querySelector('.ascii-section').scrollIntoView({
                behavior: 'smooth'
            });
        }

        function scrollToContact() {
            document.querySelector('.contact-section').scrollIntoView({
                behavior: 'smooth'
            });
        }

        function scrollToCreativity() {
            document.querySelector('.creativity-section').scrollIntoView({
                behavior: 'smooth'
            });
        }

        function scrollToTop() {
            document.querySelector('.page-section').scrollIntoView({
                behavior: 'smooth'
            });
        }

        // ÊªöÂä®Âà∞Á¨¨‰∫îÈ°µÁöÑÂáΩÊï∞
        function scrollToView() {
            document.querySelector('.view-section').scrollIntoView({
                behavior: 'smooth'
            });
        }

        // ÁúºÁùõË∑üË∏™Èº†Ê†áÊïàÊûú
        function initEyeTracking() {
            const eyePupil = document.querySelector('.eye-pupil');
            const eyeBackground = document.querySelector('.eye-background');
            const viewSection = document.querySelector('.view-section');

            if (!eyePupil || !eyeBackground || !viewSection) return;

            let isEyeTrackingActive = false;

            // ‰ΩøÁî®Intersection ObserverÊ£ÄÊµãÁ¨¨‰∫îÈ°µÊòØÂê¶ÂèØËßÅ
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.target === viewSection) {
                        isEyeTrackingActive = entry.isIntersecting;
                        if (!isEyeTrackingActive) {
                            // ÂΩìÁ¶ªÂºÄÁ¨¨‰∫îÈ°µÊó∂ÔºåÈáçÁΩÆÁû≥Â≠î‰ΩçÁΩÆ
                            eyePupil.style.transform = 'translate(0px, 0px)';
                        }
                    }
                });
            }, {
                threshold: 0.3 // ÂΩì30%ÂèØËßÅÊó∂ÊøÄÊ¥ª
            });

            observer.observe(viewSection);

            document.addEventListener('mousemove', function (e) {
                if (!isEyeTrackingActive) return;

                // Ëé∑ÂèñÁúºÁêÉ‰∏≠ÂøÉ‰ΩçÁΩÆ
                const eyeRect = eyeBackground.getBoundingClientRect();
                const eyeCenterX = eyeRect.left + eyeRect.width / 2;
                const eyeCenterY = eyeRect.top + eyeRect.height / 2;

                // ËÆ°ÁÆóÈº†Ê†áÁõ∏ÂØπ‰∫éÁúºÁêÉ‰∏≠ÂøÉÁöÑ‰ΩçÁΩÆ
                const mouseX = e.clientX - eyeCenterX;
                const mouseY = e.clientY - eyeCenterY;

                // ËÆ°ÁÆóË∑ùÁ¶ªÂíåËßíÂ∫¶
                const distance = Math.sqrt(mouseX * mouseX + mouseY * mouseY);
                const angle = Math.atan2(mouseY, mouseX);

                // ÈôêÂà∂Áû≥Â≠îÁßªÂä®ËåÉÂõ¥ÔºàÁúºÁêÉÂçäÂæÑÁöÑ30%Ôºâ
                const maxDistance = 45; // ÁúºÁêÉÂçäÂæÑ150pxÁöÑ30%
                const limitedDistance = Math.min(distance * 0.3, maxDistance);

                // ËÆ°ÁÆóÁû≥Â≠îÊñ∞‰ΩçÁΩÆ
                const pupilX = Math.cos(angle) * limitedDistance;
                const pupilY = Math.sin(angle) * limitedDistance;

                // Â∫îÁî®ÂèòÊç¢
                eyePupil.style.transform = `translate(${pupilX}px, ${pupilY}px)`;

                // ËÆ©È´òÂÖâ‰πüË∑üÁùÄÁßªÂä®Ôºå‰ΩÜÁßªÂä®ÂπÖÂ∫¶Êõ¥Â∞è
                const eyeHighlight = eyePupil.querySelector('.eye-highlight');
                if (eyeHighlight) {
                    const highlightX = pupilX * 0.3;
                    const highlightY = pupilY * 0.3;
                    eyeHighlight.style.transform = `translate(${highlightX}px, ${highlightY}px)`;
                }
            });
        }

        // Á¨¨‰∏âÈ°µÂØºËà™‰∫§‰∫í
        document.addEventListener('DOMContentLoaded', function () {
            const navItems = document.querySelectorAll('.nav-item');

            navItems.forEach(item => {
                item.addEventListener('mouseenter', function () {
                    // ÁßªÈô§ÊâÄÊúâactiveÁ±ª
                    navItems.forEach(nav => nav.classList.remove('active'));
                    // Ê∑ªÂä†activeÁ±ªÂà∞ÂΩìÂâçÈ°π
                    this.classList.add('active');
                });
            });

            // ÂàõÂª∫Âª∫Á≠ëÁâ©Á™óÊà∑
            createBuildingWindows();

            // ËÆæÁΩÆÁ¨¨‰∏âÈ°µÊªëÂä®Âä®ÁîªËßÇÂØüÂô®
            setupThirdPageAnimation();

            // ÂàùÂßãÂåñÁâ©ÁêÜÂºïÊìé
            initPhysicsEngine();

            // ÂàùÂßãÂåñÁúºÁùõË∑üË∏™ÊïàÊûú
            initEyeTracking();
        });

        // ËÆæÁΩÆÁ¨¨‰∏âÈ°µÂä®ÁîªËßÇÂØüÂô®
        function setupThirdPageAnimation() {
            const contactSection = document.querySelector('.contact-section');
            const navItems = document.querySelectorAll('.nav-item');

            // ÂàùÂßãÁä∂ÊÄÅÔºöÁßªÈô§ÊâÄÊúâÂä®ÁîªÔºåÈöêËóèÂØºËà™È°π
            navItems.forEach(item => {
                item.style.opacity = '0';
                item.style.transform = 'translateX(-100px)';
                item.style.animation = 'none';
            });

            // ÂàõÂª∫ËßÇÂØüÂô®
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        // È°µÈù¢ËøõÂÖ•ËßÜÁ™óÔºåÂêØÂä®Âä®Áîª
                        startNavAnimation();
                    } else {
                        // È°µÈù¢Á¶ªÂºÄËßÜÁ™óÔºåÈáçÁΩÆÂä®Áîª
                        resetNavAnimation();
                    }
                });
            }, {
                threshold: 0.3 // ÂΩì30%ÁöÑÈ°µÈù¢ÂèØËßÅÊó∂Ëß¶Âèë
            });

            observer.observe(contactSection);
        }

        // ÂêØÂä®ÂØºËà™Âä®Áîª
        function startNavAnimation() {
            const navItems = document.querySelectorAll('.nav-item');

            navItems.forEach((item, index) => {
                // ÈáçÊñ∞Â∫îÁî®Âä®Áîª
                item.style.animation = `slideInLeft 0.6s ease forwards`;
                item.style.animationDelay = `${0.1 * (index + 1)}s`;
            });
        }

        // ÈáçÁΩÆÂØºËà™Âä®Áîª
        function resetNavAnimation() {
            const navItems = document.querySelectorAll('.nav-item');

            navItems.forEach(item => {
                item.style.opacity = '0';
                item.style.transform = 'translateX(-100px)';
                item.style.animation = 'none';
            });
        }

        // ÂàõÂª∫Âª∫Á≠ëÁâ©Á™óÊà∑
        function createBuildingWindows() {
            const buildings = [
                { id: 'building1', windows: 12 },
                { id: 'building2', windows: 20 },
                { id: 'building3', windows: 30 },
                { id: 'building4', windows: 16 },
                { id: 'building5', windows: 10 }
            ];

            buildings.forEach(building => {
                const buildingEl = document.getElementById(building.id);
                if (!buildingEl) return;

                for (let i = 0; i < building.windows; i++) {
                    const window = document.createElement('div');
                    window.className = 'window';

                    // ÈöèÊú∫ÂÜ≥ÂÆöÊòØÂê¶ÁÇπ‰∫ÆÁ™óÊà∑
                    if (Math.random() > 0.6) {
                        window.classList.add('lit');
                    }

                    // ÈöèÊú∫‰ΩçÁΩÆ
                    const x = 10 + (i % 4) * 18;
                    const y = 15 + Math.floor(i / 4) * 20;

                    window.style.left = x + 'px';
                    window.style.top = y + 'px';

                    buildingEl.appendChild(window);
                }
            });
        }

        // Á¨¨ÂõõÈ°µÁâ©ÁêÜÂºïÊìé
        class PhysicsEngine {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.circles = [];
                this.gravity = 0.3;
                this.friction = 0.98;
                this.bounceDamping = 0.8;
                this.scrollForce = 0;
                this.totalCircles = 8; // ÂáèÂ∞ëÊï∞ÈáèÔºåÂõ†‰∏∫ÁÅØÊ≥°ÂèòÂ§ß‰∫Ü
                this.filledCircles = 0;

                // È¢ÑÂä†ËΩΩÁÅØÊ≥°ÂõæÁâá
                this.lightOffImg = new Image();
                this.lightOnImg = new Image();
                this.lightOffImg.src = 'imerge/lightoff.png';
                this.lightOnImg.src = 'imerge/lighton.png';

                // ÁÅØÊ≥°ÁöÑÂÆûÈôÖÂ§ßÂ∞èÂíåÁ¢∞ÊíûÂå∫ÂüüÔºàÂü∫‰∫éÁÅØÊ≥°ËΩÆÂªìÔºâ- ÊîæÂ§ß3ÂÄç
                this.bulbWidth = 120;  // 40 * 3
                this.bulbHeight = 180; // 60 * 3
                this.bulbCollisionRadius = 60; // 20 * 3 - ÁÅØÊ≥°‰∏ª‰ΩìÁöÑÁ¢∞ÊíûÂçäÂæÑ

                this.resizeCanvas();
                this.initCircles();
                this.animate();

                window.addEventListener('resize', () => this.resizeCanvas());
                canvas.addEventListener('click', (e) => this.handleClick(e));

                // ÁõëÂê¨ÊªöÂä®
                let lastScrollY = window.scrollY;
                window.addEventListener('scroll', () => {
                    const currentScrollY = window.scrollY;
                    const scrollDelta = currentScrollY - lastScrollY;
                    this.scrollForce = scrollDelta * 0.1;
                    lastScrollY = currentScrollY;
                });
            }

            resizeCanvas() {
                this.canvas.width = this.canvas.offsetWidth;
                this.canvas.height = this.canvas.offsetHeight;
            }

            initCircles() {
                this.circles = [];
                for (let i = 0; i < this.totalCircles; i++) {
                    this.circles.push({
                        x: Math.random() * this.canvas.width,
                        y: Math.random() * this.canvas.height,
                        vx: (Math.random() - 0.5) * 4,
                        vy: (Math.random() - 0.5) * 4,
                        radius: this.bulbCollisionRadius, // ‰ΩøÁî®ÁÅØÊ≥°Á¢∞ÊíûÂçäÂæÑ
                        filled: false, // falseË°®Á§∫ÁÅØÁÅ≠ÔºåtrueË°®Á§∫ÁÅØ‰∫Æ
                        color: '#14ffeb',
                        width: this.bulbWidth,
                        height: this.bulbHeight,
                        rotation: Math.random() * Math.PI * 2, // ÈöèÊú∫ÂàùÂßãÊóãËΩ¨ËßíÂ∫¶
                        angularVelocity: (Math.random() - 0.5) * 0.02 // ËßíÈÄüÂ∫¶
                    });
                }
            }

            handleClick(e) {
                const rect = this.canvas.getBoundingClientRect();
                const clickX = e.clientX - rect.left;
                const clickY = e.clientY - rect.top;

                this.circles.forEach(circle => {
                    // Ê£ÄÊü•ÁÇπÂáªÊòØÂê¶Âú®ÁÅØÊ≥°ÁöÑÁ¢∞ÊíûÂå∫ÂüüÂÜÖÔºàÊ§≠ÂúÜÂΩ¢Âå∫ÂüüÔºâ
                    const dx = clickX - circle.x;
                    const dy = clickY - circle.y;

                    // ‰ΩøÁî®Ê§≠ÂúÜÁ¢∞ÊíûÊ£ÄÊµãÔºåÁÅØÊ≥°‰∏ª‰ΩìÂå∫Âüü
                    const normalizedX = dx / (circle.width * 0.4); // ÂÆΩÂ∫¶ÁöÑ40%‰Ωú‰∏∫Á¢∞ÊíûÂå∫Âüü
                    const normalizedY = dy / (circle.height * 0.5); // È´òÂ∫¶ÁöÑ50%‰Ωú‰∏∫Á¢∞ÊíûÂå∫Âüü
                    const distance = Math.sqrt(normalizedX * normalizedX + normalizedY * normalizedY);

                    if (distance <= 1 && !circle.filled) {
                        circle.filled = true;
                        this.filledCircles++;

                        // Ê∑ªÂä†ÁÇπÂáªÊïàÊûú
                        circle.vx += (Math.random() - 0.5) * 5;
                        circle.vy -= Math.random() * 3 + 2;

                        // Ê∑ªÂä†ÊóãËΩ¨ÊïàÊûú
                        circle.angularVelocity += (Math.random() - 0.5) * 0.1;

                        if (this.filledCircles === this.totalCircles) {
                            setTimeout(() => this.showCongratulations(), 500);
                        }
                    }
                });
            }

            showCongratulations() {
                document.getElementById('congratulationModal').style.display = 'block';
            }

            animate() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

                this.circles.forEach(circle => {
                    // Â∫îÁî®ÈáçÂäõ
                    circle.vy += this.gravity;

                    // Â∫îÁî®ÊªöÂä®Âäõ
                    circle.vy += this.scrollForce;

                    // Â∫îÁî®Êë©Êì¶Âäõ
                    circle.vx *= this.friction;
                    circle.vy *= this.friction;

                    // Êõ¥Êñ∞‰ΩçÁΩÆ
                    circle.x += circle.vx;
                    circle.y += circle.vy;

                    // Ê†πÊçÆÁßªÂä®ÈÄüÂ∫¶Êõ¥Êñ∞ÊóãËΩ¨ËßíÂ∫¶
                    const speed = Math.sqrt(circle.vx * circle.vx + circle.vy * circle.vy);
                    circle.angularVelocity += speed * 0.001; // ÈÄüÂ∫¶Ë∂äÂø´ÊóãËΩ¨Ë∂äÂø´
                    circle.angularVelocity *= 0.98; // ËßíÈÄüÂ∫¶ÈòªÂ∞º
                    circle.rotation += circle.angularVelocity;

                    // ËæπÁïåÁ¢∞ÊíûÔºàËÄÉËôëÁÅØÊ≥°ÂõæÁâáÁöÑÂÆûÈôÖÂ∞∫ÂØ∏Ôºâ
                    const halfWidth = circle.width / 2;
                    const halfHeight = circle.height / 2;

                    if (circle.x < halfWidth) {
                        circle.x = halfWidth;
                        circle.vx *= -this.bounceDamping;
                        circle.angularVelocity += Math.abs(circle.vx) * 0.005; // ËæπÁïåÁ¢∞Êíû‰∫ßÁîüÊóãËΩ¨
                    }
                    if (circle.x > this.canvas.width - halfWidth) {
                        circle.x = this.canvas.width - halfWidth;
                        circle.vx *= -this.bounceDamping;
                        circle.angularVelocity -= Math.abs(circle.vx) * 0.005;
                    }
                    if (circle.y < halfHeight) {
                        circle.y = halfHeight;
                        circle.vy *= -this.bounceDamping;
                        circle.angularVelocity += Math.abs(circle.vy) * 0.005;
                    }
                    if (circle.y > this.canvas.height - halfHeight) {
                        circle.y = this.canvas.height - halfHeight;
                        circle.vy *= -this.bounceDamping;
                        circle.angularVelocity -= Math.abs(circle.vy) * 0.005;
                    }                    // ÁÅØÊ≥°Á¢∞ÊíûÊ£ÄÊµãÔºàÂü∫‰∫éÁÅØÊ≥°ËΩÆÂªìÁöÑÂúÜÂΩ¢Âå∫ÂüüÔºâ
                    this.circles.forEach(other => {
                        if (other !== circle) {
                            const dx = other.x - circle.x;
                            const dy = other.y - circle.y;
                            const distance = Math.sqrt(dx * dx + dy * dy);
                            const minDistance = circle.radius + other.radius;

                            if (distance < minDistance) {
                                const angle = Math.atan2(dy, dx);
                                const targetX = circle.x + Math.cos(angle) * minDistance;
                                const targetY = circle.y + Math.sin(angle) * minDistance;
                                const ax = (targetX - other.x) * 0.1;
                                const ay = (targetY - other.y) * 0.1;

                                circle.vx -= ax;
                                circle.vy -= ay;
                                other.vx += ax;
                                other.vy += ay;

                                // Á¢∞ÊíûÊó∂Â¢ûÂä†ÊóãËΩ¨ÊïàÊûú
                                const rotationImpact = (ax + ay) * 0.01;
                                circle.angularVelocity += rotationImpact;
                                other.angularVelocity -= rotationImpact;
                            }
                        }
                    });

                    // ÁªòÂà∂ÁÅØÊ≥°ÂõæÁâá
                    const img = circle.filled ? this.lightOnImg : this.lightOffImg;

                    // Â¶ÇÊûúÂõæÁâáÂ∑≤Âä†ËΩΩÂÆåÊàêÔºåÂàôÁªòÂà∂ÂõæÁâá
                    if (img.complete && img.naturalHeight !== 0) {
                        // ‰øùÂ≠òÂΩìÂâçcanvasÁä∂ÊÄÅ
                        this.ctx.save();

                        // ÁßªÂä®Âà∞ÁÅØÊ≥°‰∏≠ÂøÉ
                        this.ctx.translate(circle.x, circle.y);

                        // Â∫îÁî®ÊóãËΩ¨
                        this.ctx.rotate(circle.rotation);

                        // Ê∑ªÂä†ÂèëÂÖâÊïàÊûú
                        if (circle.filled) {
                            this.ctx.shadowColor = '#ffff00';
                            this.ctx.shadowBlur = 30; // Â¢ûÂº∫ÂèëÂÖâÊïàÊûú
                        }

                        // ÁªòÂà∂ÁÅØÊ≥°ÂõæÁâáÔºå‰ª•ÂéüÁÇπ‰∏∫‰∏≠ÂøÉ
                        this.ctx.drawImage(
                            img,
                            -circle.width / 2,
                            -circle.height / 2,
                            circle.width,
                            circle.height
                        );

                        // ÊÅ¢Â§çcanvasÁä∂ÊÄÅ
                        this.ctx.restore();
                    } else {
                        // ÂõæÁâáÊú™Âä†ËΩΩÂÆåÊàêÊó∂ÔºåÁªòÂà∂Âç†‰ΩçÂúÜÂúà
                        this.ctx.beginPath();
                        this.ctx.arc(circle.x, circle.y, circle.radius, 0, Math.PI * 2);

                        if (circle.filled) {
                            this.ctx.fillStyle = '#ffff00';
                            this.ctx.fill();
                            this.ctx.shadowColor = '#ffff00';
                            this.ctx.shadowBlur = 15;
                        } else {
                            this.ctx.strokeStyle = circle.color;
                            this.ctx.lineWidth = 3;
                            this.ctx.stroke();
                        }

                        this.ctx.shadowBlur = 0;
                    }
                });

                // ÂáèÂ∞ëÊªöÂä®Âäõ
                this.scrollForce *= 0.9;

                requestAnimationFrame(() => this.animate());
            }
        }

        // ÊÅ≠ÂñúÂºπÁ™óÂäüËÉΩ
        function closeModal() {
            document.getElementById('congratulationModal').style.display = 'none';
        }

        // ÂàùÂßãÂåñÁâ©ÁêÜÂºïÊìé
        let physicsEngine;
        function initPhysicsEngine() {
            const canvas = document.getElementById('physicsCanvas');
            if (canvas) {
                physicsEngine = new PhysicsEngine(canvas);
            }
        }

    </script>


    <script type="module">






        import { parseGIF, decompressFrames } from 'https://cdn.jsdelivr.net/npm/gifuct-js@2.1.2/+esm';

        // Ëé∑ÂèñASCIIÊòæÁ§∫ÂÆπÂô®
        const asciiContainer = document.getElementById('asciiContainer');
        asciiContainer.style.color = '#14ffeb';
        asciiContainer.style.fontFamily = 'monospace';
        asciiContainer.style.fontSize = '8px';
        asciiContainer.style.lineHeight = '1.0';
        asciiContainer.style.margin = '0';
        asciiContainer.style.padding = '0';
        asciiContainer.style.textAlign = 'center';
        asciiContainer.style.width = '100%';
        asciiContainer.style.height = '100%';
        asciiContainer.style.display = 'flex';
        asciiContainer.style.alignItems = 'center';
        asciiContainer.style.justifyContent = 'center';
        asciiContainer.style.whiteSpace = 'pre';
        asciiContainer.style.overflow = 'hidden';

        const scale_nums = 2; // ÊéßÂà∂ASCIIÂàÜËæ®ÁéáÔºåÊï∞ÂÄºË∂äÂ∞èÂàÜËæ®ÁéáË∂äÈ´ò
        let texts = [];
        let current_text_index = 0;

        function create_texts(data, width, height) {
            let text = "";
            const levels = [["@", "#", "S", "%", "?", "*", "+", ";", ":", ",", ".", " "], ["0", "1"], [".", "*"], [" "]];
            for (let y = 0; y < height; y += scale_nums) {
                let row = "";
                for (let x = 0; x < width; x += scale_nums) {
                    const i = (y * width + x) * 4;
                    const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
                    const level = levels[0][Math.floor(avg / 255 * (levels[0].length - 1))];
                    row += level;
                }
                text += row + "\n";
            }
            return text;
        }

        const ascllbox = {
            init() {
                fetch('imerge/head.gif')
                    .then(response => response.arrayBuffer())
                    .then(buffer => {
                        const gif = parseGIF(buffer);
                        const frames = decompressFrames(gif, true);
                        texts = frames.map(frame => {
                            // ÂàõÂª∫canvasËé∑ÂèñÂÉèÁ¥†Êï∞ÊçÆ
                            const canvas = document.createElement('canvas');
                            canvas.width = frame.dims.width;
                            canvas.height = frame.dims.height;
                            const ctx = canvas.getContext('2d');
                            const imageData = new ImageData(frame.patch, frame.dims.width, frame.dims.height);
                            ctx.putImageData(imageData, 0, 0);
                            const data = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
                            return create_texts(data, canvas.width, canvas.height);
                        });
                        // ÂÆöÊó∂ÂàáÊç¢ÊòæÁ§∫
                        setInterval(() => {
                            current_text_index = (current_text_index + 1) % texts.length;
                            asciiContainer.innerText = texts[current_text_index];
                        }, 80);
                    })
                    .catch(error => console.error('Error loading GIF:', error));
            }
        };
        ascllbox.init();

    </script>
    <script src="static/js/music-player.js"></script>
</body>

</html>